task_id	priority	area	description	acceptance_criteria	files_touched	depends_on	notes
CCC-001	P0	events	Implement Canvas Reducer Infrastructure	Create a `CanvasReducer` class that accepts a base SceneV2 and a list of Commands, returning a new SceneV2. Must support pluggable handlers.	Unit tests pass for `reducer.apply(scene, [cmd])`.	engines/canvas_stream/reducer/core.py, engines/canvas_stream/reducer/handlers.py		The core engine of the canvas.
CCC-002	P0	events	Implement Node Creation Handler	Implement reducer handler for `create_node` command type.	Test: `apply(empty_scene, create_node_cmd)` results in scene with 1 node.	engines/canvas_stream/reducer/handlers.py	CCC-001	Start with basic primitives.
CCC-003	P1	events	Implement Transform Update Handler	Implement reducer handler for `update_transform` command type.	Test: `apply(scene_with_node, transform_cmd)` results in moved node.	engines/canvas_stream/reducer/handlers.py	CCC-002	
CCC-004	P1	events	Wire Reducer to Replay Service	Update `engines/canvas_stream/replay.py` to use the new Reducer logic instead of returning stub data.	`ReplayService.generate_keyframe` returns actual node data from command log history.	engines/canvas_stream/replay.py	CCC-001	Connecting the pieces.
CCC-005	P1	storage	Implement Snapshotting Trigger	Create logic to save the result of `ReplayService.generate_keyframe` back to `SceneStoreService` as a cache/snapshot.	Invoking snapshot logic results in a new blob in Firestore `scene_v2_store`.	engines/canvas_commands/snapshot.py	CCC-004	Critical for performance on long histories.
CCC-006	P2	agent-tools	Create Agent Canvas Client	create a python client wrapper for agents to easily read/mutate canvas state.	`client.add_node(...)` sends correct HTTP POST to command endpoint.	engines/mcp_gateway/canvas_client.py		Easier consumption for internal agents.
CCC-007	P0	tests	Deterministic Replay Test	Add a test case that acts as the "Golden Master": Start with empty, apply 10 random commands, snapshot S1. Replay 10 commands on empty, assert Result == S1.	Test passes in CI.	engines/canvas_stream/tests/test_determinism.py	CCC-004	The "Proof of Life" test.
